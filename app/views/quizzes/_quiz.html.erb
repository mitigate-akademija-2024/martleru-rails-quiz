<section id="<%= dom_id(quiz) %>" class="px-4 py-4">
  <div class="flex flex-col space-y-8">
    <div class="flex flex-col justify-between mb-9">
      <div class="flex gap-3 items-baseline">
        <h2 class="break-words font-bold text-3xl">
          <%= quiz.title %>
        </h2>
        <% if quiz.owned_by?(current_user) %>
          <%= button_to quiz, method: :delete do %>
            <%= raw destroy_quiz_svg %>
          <% end %>

          <%= link_to edit_quiz_path(@quiz) do %>
            <%= raw edit_quiz_svg %> 
          <% end %>

        <% end %>
      </div>
      <hr class="my-4">
      <p class="break-words text-lg text-gray-700">
        <strong>Description:</strong> <%= quiz.description %>
      </p>
      <% if quiz.questions.size > 0 %>
        <div>
          <%= link_to "Play Quiz", play_quiz_quiz_path(quiz), class: "inline-block rounded-md bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-300" %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="flex space-x-8">
    <% if quiz.owned_by?(current_user) %>
      <div class="w-2/3">
        <h3 class="text-2xl font-semibold mb-6">Quiz questions (<%= quiz.questions.size %>)</h3>
        <div class="space-y-6">
          <% quiz.questions.each do |question| %>
            <div class="p-4 rounded-lg border border-gray-900 bg-white shadow-sm">
              <div class="flex justify-between items-start">
                <div>
                  <h4 class="text-xl font-bold text-gray-900"><%= question.question_text %></h4>
                </div>
                <div class="flex space-x-4">
                  <%= link_to "Edit", edit_question_path(question), class: 'inline-block rounded border border-indigo-600 px-3 py-1 text-sm font-medium text-indigo-600 hover:bg-indigo-600 hover:text-white focus:outline-none focus:ring active:bg-indigo-500' %>
                  <%= button_to "Delete", question, method: :delete, data: { confirm: 'Are you sure you want to delete this question?' }, class: 'inline-block rounded border border-red-600 px-3 py-1 text-sm font-medium text-red-600 hover:bg-red-600 hover:text-white focus:outline-none focus:ring active:bg-red-500' %>
                </div>
              </div>

              <ul class="mt-2 flex flex-wrap justify-between">
                <% question.answers.each do |answer| %>
                  <li class="w-full md:w-1/2 lg:w-1/4 p-2">
                    <div class="flex items-center justify-center h-full p-4 border border-gray-300 rounded-lg <%= answer.correct ? 'bg-green-100' : 'bg-gray-100' %>">
                      <p class="<%= answer.correct ? 'font-semibold text-green-600' : 'text-gray-700' %>">
                        <%= answer.answer_text %>
                      </p>
                    </div>
                  </li>
                <% end %>
              </ul>
            </div>
          <% end %>
        </div>
        <div class="mt-10">
          <%= link_to "Add Question", new_quiz_question_path(quiz), class: "inline-block mb-6 rounded-md border border-gray-300 bg-gray-100 px-6 py-2 text-sm font-medium text-gray-800 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-300" %>
        </div>
      </div>
    <% end %>

<div class="<%= quiz.owned_by?(current_user) ? 'w-1/3' : 'w-full' %>">
  <h3 class="text-2xl font-semibold mb-6">Highest scores</h3>
  <% if quiz.user_scores.size > 0 %>
    <div class="overflow-x-auto rounded-lg border border-gray-200">
      <table id="quizzes" class="min-w-full divide-y-2 divide-gray-200 bg-white text-sm">
        <thead class="text-left">
          <tr>
            <th class="whitespace-nowrap px-4 py-2 font-medium text-gray-900">E-mail</th>
            <th class="whitespace-nowrap px-4 py-2 font-medium text-gray-900">Result</th>
            <th class="whitespace-nowrap px-4 py-2 font-medium text-gray-900">Time</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <% @user_scores.each do |user_score| %>
            <tr>
              <td class="whitespace-nowrap px-4 py-2 text-gray-900"><%= user_score.user&.email || "Anonymous" %></td>
              <td class="whitespace-nowrap px-4 py-2 text-gray-900"><%= "#{(user_score.score.to_f / quiz.questions.count * 100).round(2)}%" %></td>
              <td class="whitespace-nowrap px-4 py-2 text-gray-900"><%= format_date("date_time", user_score.created_at) %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <p class="text-gray-500 px-4 py-2">Nav pieejamu rezultƒÅtu.</p>
  <% end %>
</div>


  </div>
</section>
